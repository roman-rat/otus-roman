# Проект Vagrant + Ansible для автоматической настройки сервера на CentOS 9 c Nginx

## Описание

Этот проект автоматизирует процесс развертывания и настройки веб-сервера Nginx на базе CentOS 9 с использованием Vagrant и Ansible. В результате работы создается виртуальная машина (ВМ) с установленным и настроенным Nginx, а также развертывается простое веб-содержимое.

## Структура проекта

Проект состоит из следующих файлов и папок:

- **Vagrantfile**  
  Файл конфигурации Vagrant, описывающий параметры ВМ и команды для провижининга через Shell и Ansible.

- **playbook.yml**  
  Определяет шаги для установки и настройки веб-сервера Nginx.

- **inventory.ini**  
  Содержит информацию о сервере, на который будет установлен Nginx.

- **vault.yml**  
  Хранит зашифрованные пароли для доступа по SSH и использования sudo на ВМ. Пароль для расшифровки файла: `17896520` (необходим для проверки ДЗ).

- **files**  
  Папка с шаблонами конфигурационных файлов для Nginx:
  - **nginx.conf.j2**: Шаблон конфигурации Nginx, настраивающий сервер для прослушивания на порту, указанном в плейбуке, и обслуживания содержимого из папки `/var/www/html`.
  - **index.html.j2**: Шаблон HTML-страницы, которая будет отображаться на сайте. Содержимое страницы задается переменной `site_content`, указанной в плейбуке.

## Описание Vagrantfile

Файл `Vagrantfile` управляет созданием и настройкой виртуальной машины и включает следующие параметры:

- **Базовый образ**:  
  Используется образ `generic/centos9s` для создания ВМ.

- **Настройки ВМ**:  
  Виртуальная машина называется `CentosWEB` и имеет аналогичные параметры с предыдущими уроками.

- **Сеть**:  
  ВМ настроена на использование публичной сети с IP-адресом `192.168.1.125`.

### Провижининг Shell

- Создается пользователь `roman`, которому назначается пароль, и он получает права администратора (sudo).
- Обновляются пакеты на ВМ с помощью `dnf update`.

### Провижининг Ansible через playbook.yml

- Ansible используется для установки Nginx и настройки веб-сервера.
- Пароли зашифрованы с помощью Ansible Vault для обеспечения безопасности.
- Локальная папка `files/` синхронизирована с `/vagrant/files` на ВМ, чтобы Ansible мог использовать шаблоны конфигурационных файлов.

## Описание playbook.yml

Файл `playbook.yml` описывает шаги для настройки веб-сервера:

- **Переменные**:
  - Переменные для порта Nginx (`nginx_port`) и содержимого веб-страницы (`site_content`).
  - Указан зашифрованный файл `vault.yml` для хранения паролей.

- **Таски**:
  1. Установка Nginx.
  2. Создание папки для веб-файлов.
  3. Развертывание `index.html` из шаблона `index.html.j2`.
  4. Развертывание конфигурационного файла Nginx из шаблона `nginx.conf.j2`.
  5. Перезапуск и настройка автозапуска Nginx, если конфигурация изменится.


